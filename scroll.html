<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Ambient Mode - Select</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        margin: 0;
        font-family: "Quicksand", Arial, sans-serif;
        background: linear-gradient(135deg, #232526 0%, #414345 100%);
        color: #fff;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }
      .carousel-bg {
        width: 100vw;
        min-height: 60vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        background: linear-gradient(
          120deg,
          rgba(40, 44, 52, 0.92) 60%,
          rgba(60, 70, 90, 0.85) 100%
        );
        border-radius: 32px;
        box-shadow: 0 8px 48px 0 rgba(0, 0, 0, 0.22);
        margin: 48px 0 0 0;
        padding: 32px 0 24px 0;
      }
      #carousel-container {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 32px;
        width: 100%;
        max-width: 700px;
        margin: 0 auto;
      }
      .carousel-arrow {
        background: rgba(30, 30, 30, 0.85);
        color: #fff;
        border: none;
        border-radius: 50%;
        width: 48px;
        height: 48px;
        font-size: 2.2em;
        cursor: pointer;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.18);
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background 0.2s, color 0.2s, transform 0.2s;
        outline: none;
      }
      .carousel-arrow:hover,
      .carousel-arrow:focus {
        background: #43e97b;
        color: #232526;
        transform: scale(1.12);
      }
      .preview {
        width: 340px;
        max-width: 80vw;
        height: 220px;
        min-height: 120px;
        max-height: 260px;
        background: #232526;
        border-radius: 22px;
        display: flex;
        align-items: flex-end;
        justify-content: center;
        position: relative;
        cursor: pointer;
        box-shadow: 0 4px 24px 0 rgba(0, 0, 0, 0.18);
        transition: transform 0.25s, box-shadow 0.25s;
        outline: none;
        overflow: hidden;
      }
      .video-wrapper {
        width: 100%;
        height: 100%;
        position: absolute;
        top: 0;
        left: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 22px;
        overflow: hidden;
      }
      .preview video {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 22px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        transition: filter 0.3s;
      }
      .play-overlay {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.2s;
      }
      .preview:hover .play-overlay,
      .preview:focus .play-overlay {
        opacity: 1;
      }
      .preview span {
        position: absolute;
        bottom: 18px;
        left: 24px;
        background: rgba(30, 30, 30, 0.7);
        padding: 10px 22px;
        border-radius: 14px;
        font-size: 1.2em;
        font-weight: 700;
        letter-spacing: 0.04em;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.18);
        border: 1.5px solid rgba(255, 255, 255, 0.12);
      }
      .carousel-dots {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 12px;
        margin-top: 24px;
      }
      .carousel-dot {
        width: 16px;
        height: 16px;
        border-radius: 50%;
        background: #3a4fff;
        opacity: 0.35;
        border: none;
        transition: opacity 0.2s, background 0.2s;
        cursor: pointer;
      }
      .carousel-dot.active {
        opacity: 1;
        background: #4a6cff;
      }

      /* --- Carousel container --- */
      #carousel-container {
        flex: 1;
        display: flex;
        justify-content: center;
        align-items: center;
        position: relative;
        width: 100%;
        max-width: 1000px;
        overflow: hidden;
      }

      .carousel-track {
        display: flex;
        transition: transform 0.5s ease;
        gap: 40px;
      }

      .preview {
        width: 300px;
        height: 180px;
        background: #222;
        border-radius: 16px;
        overflow: hidden;
        flex-shrink: 0;
        position: relative;
        cursor: pointer;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.35);
        transition: transform 0.4s ease, box-shadow 0.4s ease;
      }

      .preview video {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
      }

      .preview span {
        position: absolute;
        bottom: 10px;
        left: 12px;
        background: rgba(0, 0, 0, 0.6);
        padding: 6px 14px;
        border-radius: 8px;
        font-size: 1em;
        font-weight: 700;
      }

      /* Focused card bigger */
      .preview.active {
        transform: scale(1.15);
        box-shadow: 0 12px 40px rgba(0, 0, 0, 0.6);
        z-index: 2;
      }

      /* Left/right arrows */
      #carousel-left,
      #carousel-right {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        font-size: 2rem;
        background: rgba(0, 0, 0, 0.5);
        border: none;
        color: white;
        padding: 12px;
        border-radius: 50%;
        cursor: pointer;
        transition: background 0.3s;
        z-index: 3;
      }
      #carousel-left:hover,
      #carousel-right:hover {
        background: rgba(0, 0, 0, 0.8);
      }
      #carousel-left {
        left: 20px;
      }
      #carousel-right {
        right: 20px;
      }

      /* Dots indicator */
      .carousel-dots {
        display: flex;
        gap: 10px;
        justify-content: center;
        margin: 15px 0;
      }
      .carousel-dots div {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.4);
        cursor: pointer;
        transition: background 0.3s;
      }
      .carousel-dots div.active {
        background: #43e97b;
      }

      /* Controls */
      .controls {
        margin-bottom: 25px;
        background: rgba(30, 30, 30, 0.85);
        padding: 14px 24px;
        border-radius: 14px;
        display: flex;
        gap: 14px;
        align-items: center;
        box-shadow: 0 4px 18px rgba(0, 0, 0, 0.25);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }
      .controls input {
        width: 70px;
        padding: 6px 8px;
        font-size: 1.1em;
        border-radius: 8px;
        border: 1.5px solid #4caf50;
        background: #1c1c1c;
        color: #fff;
      }
      .controls button {
        padding: 8px 20px;
        font-size: 1.1em;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        background: linear-gradient(90deg, #43e97b 0%, #38f9d7 100%);
        color: #111;
        font-weight: 700;
        letter-spacing: 0.03em;
      }
    </style>
  </head>
  <body>
    <div id="carousel-container">
      <button id="carousel-left">&#10094;</button>
      <div class="carousel-track" id="carousel-track">
        <div class="preview active">
          <video src="mov.mp4" muted loop></video><span>Forest</span>
        </div>
        <div class="preview">
          <video src="videos/ocean.mp4" muted loop></video><span>Ocean</span>
        </div>
        <div class="preview">
          <video src="videos/fireplace.mp4" muted loop></video
          ><span>Fireplace</span>
        </div>
      </div>
      <button id="carousel-right">&#10095;</button>
    </div>
    <div class="carousel-dots" id="carousel-dots"></div>

    <div class="controls">
      <label for="minutes">Minutes:</label>
      <input type="number" id="minutes" value="10" min="1" max="180" />
      <button id="start">Start Session</button>
    </div>

    <script>
      const track = document.getElementById("carousel-track");
      const previews = Array.from(document.querySelectorAll(".preview"));
      const leftBtn = document.getElementById("carousel-left");
      const rightBtn = document.getElementById("carousel-right");
      const dotsContainer = document.getElementById("carousel-dots");
      let currentIndex = 0;

      // Create dots
      previews.forEach((_, idx) => {
        const dot = document.createElement("div");
        if (idx === 0) dot.classList.add("active");
        dotsContainer.appendChild(dot);
        dot.addEventListener("click", () => updateCarousel(idx));
      });

      function updateCarousel(idx) {
        currentIndex = idx;
        const offset = -idx * (previews[0].offsetWidth + 40); // width + gap
        track.style.transform = `translateX(${
          offset + (window.innerWidth / 2 - previews[0].offsetWidth / 2)
        }px)`;
        previews.forEach((p, i) => {
          p.classList.toggle("active", i === idx);
        });
        dotsContainer.querySelectorAll("div").forEach((dot, i) => {
          dot.classList.toggle("active", i === idx);
        });
      }

      leftBtn.addEventListener("click", () => {
        updateCarousel((currentIndex - 1 + previews.length) % previews.length);
      });
      rightBtn.addEventListener("click", () => {
        updateCarousel((currentIndex + 1) % previews.length);
      });

      // Hover to play
      previews.forEach((preview) => {
        const video = preview.querySelector("video");
        preview.addEventListener("mouseenter", () => video.play());
        preview.addEventListener("mouseleave", () => {
          video.pause();
          video.currentTime = 0;
        });
      });

      // Start button
      document.getElementById("start").addEventListener("click", () => {
        const minutes = document.getElementById("minutes").value;
        const selectedVideo = previews[currentIndex]
          .querySelector("video")
          .getAttribute("src");
        const params = new URLSearchParams({ video: selectedVideo, minutes });
        window.location.href = "session.html?" + params.toString();
      });

      // Init
      updateCarousel(0);
    </script>
  </body>
</html>
